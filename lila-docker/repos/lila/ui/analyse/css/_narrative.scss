.narrative-box {
  @extend %border-bottom-active;

  display: flex;
  flex-direction: column;
}

.narrative-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.8rem;

  padding: 0.5rem 0.7rem;
  background: $m-primary_bg--mix-80;
  border-bottom: $border;

  h2 {
    display: flex;
    align-items: center;
    gap: 0.45rem;
    margin: 0;
    font-size: 1rem;
  }

  .button {
    @extend %button-none;

    padding: 0.2rem 0.3rem;
    color: $c-font;
    opacity: 0.8;

    &:hover {
      opacity: 1;
      color: $c-over;
    }
  }
}

.narrative-content {
  padding: 0.7rem;
}

.narrative-empty {
  @extend %page-text;

  padding: 0.7rem;
  opacity: 0.75;
}

.narrative-doc {
  display: flex;
  flex-direction: column;
  gap: 0.9rem;
}

.narrative-preview {
  padding: 0.6rem;
  border: $border;
  border-radius: $box-radius-size;
  background: $c-bg-zebra;

  .pv-board {
    max-width: 240px;
    margin: 0 auto;
  }

  .pv-board-square {
    @extend %square;

    .cg-wrap {
      @extend %abs-100;
    }

    cg-board {
      @extend %popup-shadow;

      border-radius: $box-radius-size;
    }
  }
}

.narrative-preview-empty {
  @extend %page-text;

  text-align: center;
  opacity: 0.7;
}

.narrative-themes,
.narrative-concepts {
  display: flex;
  flex-wrap: wrap;
  gap: 0.35rem;
  margin: 0 0 0.5rem 0;
}

.narrative-theme,
.narrative-concept {
  display: inline-flex;
  align-items: center;
  gap: 0.4ch;
  padding: 0.1rem 0.55rem;
  border-radius: 999px;
  border: $border;
  background: $m-secondary_bg--mix-20;
  font-size: 0.82em;
  opacity: 0.95;
}

.narrative-prose {
  margin: 0;
  white-space: pre-wrap;
  line-height: 1.45;
  font-size: 0.92em;
}

.narrative-moment {
  padding: 0.65rem;
  border: $border;
  border-radius: $box-radius-size;
  background: $c-bg-box;
}

.narrative-moment-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 0.7rem;
  margin-bottom: 0.5rem;
}

.narrative-jump {
  @extend %button-none;

  font-weight: bold;
  text-align: start;
  color: $c-link;

  &:hover {
    color: $c-link-hover;
  }
}

.narrative-variations {
  margin-top: 0.7rem;

  h3 {
    margin: 0 0 0.4rem 0;
    font-size: 0.95em;
  }
}

.narrative-variation-list {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.narrative-variation {
  padding: 0.45rem 0.55rem;
  border: $border;
  border-radius: $box-radius-size;
  background: $c-bg-zebra;
}

.narrative-variation-meta {
  display: flex;
  align-items: baseline;
  gap: 0.6rem;
  margin-bottom: 0.35rem;
}

.narrative-variation-label {
  font-weight: bold;
  opacity: 0.85;
}

.narrative-variation-score {
  font-variant-numeric: tabular-nums;
  font-weight: bold;
  color: $c-primary;
}

.narrative-variation-tags {
  font-size: 0.82em;
  opacity: 0.75;
}

.narrative-variation-moves {
  display: flex;
  flex-wrap: wrap;
  align-items: baseline;
  gap: 0.25rem;

  .narrative-move-number {
    opacity: 0.65;
  }

  .narrative-move {
    @extend %san;

    cursor: help;
  }

  .narrative-move:hover {
    color: $c-primary;
  }
}
